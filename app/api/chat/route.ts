import { OpenAI } from "openai";
import { NextResponse } from "next/server";
import { prisma } from "@/app/lib/prisma";
import { cookies } from "next/headers";
import { Visitor } from "@prisma/client";

// ì´ë ¥ì„œ ë‚´ìš©ì„ ìƒìˆ˜ë¡œ ì •ì˜
const RESUME_CONTENT = `
*Last updated. 2024. 11. 22*
[ì›¹ë§í¬](https://www.notion.so/24-11-22-1455ae6dd9a68074b200d441022ef955?pvs=21)
### Profile.
- ê¹€ë²”ê·œ
- 1997ë…„ 2ì›” 28ì¼
- ê°€ì²œëŒ€í•™êµ ì»´í“¨í„°ê³µí•™, ê±´ì¶•ê³µí•™ ë³µìˆ˜ ì „ê³µ ì¡¸ì—… *[2016.03 - 2023.02]*
### Contact.
- **Email** : bkboy2067@gachon.ac.kr
- **Phone** : 010-8687-9959
### Channel.
- **Blog** : https://bkdragon0228.tistory.com/
- **Github** : https://github.com/bkdragon0228
ê°œë°œì„ ì„œë¹„ìŠ¤ì—…ì´ë¼ê³  ìƒê°í•˜ë©°, ì‚¬ìš©ì ê²½í—˜ì„ ìµœìš°ì„  ê°€ì¹˜ë¡œ ì‚¼ìŠµë‹ˆë‹¤. 
ì•ˆë…•í•˜ì„¸ìš”. í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œì ê¹€ë²”ê·œì…ë‹ˆë‹¤.
---
## Careers
### ë¸Œë¡œë„¥ìŠ¤
ì†”ë£¨ì…˜, MES, SI, WEB
ì„ í–‰ê°œë°œíŒ€
2023.09 ~ ì¬ì§
### ì£¼ì—…ë¬´
- MES í™”ë©´ ê°œë°œ
- ì‚¬ë‚´ íˆ´ ê°œë°œ
- ì‚¬ë‚´ íŒ¨í‚¤ì§€ ê°œë°œ ë° ê´€ë¦¬
- ì‹ ê·œ ì„œë¹„ìŠ¤ ê°œë°œ
### MES í™”ë©´ ê°œë°œ
ê¸°ìˆ  ìŠ¤íƒ 
React, Javascript, TailwindCSS, Redux-Toolkit
| ì—…ë¬´ëª… | ì„¤ëª… | ì¶”ê°€ ë§í¬ |
| --- | --- | --- |
| ë ˆì´ì•„ì›ƒ ì„¤ê³„ | ì œê°€ ì²˜ìŒ ì…ì‚¬í–ˆì„ ë•Œ, AXbootë¡œ ê°œë°œëœ MES ì›¹ í˜ì´ì§€ë¥¼ React ë¡œ ë³€ê²½í•˜ëŠ” ì‘ì—…ì´ ì§„í–‰ì¤‘ì´ì˜€ìŠµë‹ˆë‹¤. ì œê°€ ì…ì‚¬í•˜ê¸° ì „ê¹Œì§€ëŠ” Reactë¥¼ ì œëŒ€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒì´ ì—†ì—ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë ˆì´ì•„ì›ƒì˜ ì„¤ê³„ê°€ ë¶€ì¡±í•œ ìƒí™©ì´ì—ˆìŠµë‹ˆë‹¤. ê°€ì¥ í° ìš”êµ¬ì‚¬í•­ì€ ê° ë©”ë‰´ë¥¼ í¸í•˜ê²Œ ì´ë™í•˜ê³  ì´ë™ê³¼ì •ì—ì„œ ë³€ê²½ì‚¬í•­ì´ ì´ˆê¸°í™”ë˜ì§€ ì•Šì•„ì•¼ í–ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ íƒ­ì´ ë©”ì¸ í˜ì´ì§€ ì•ˆì—ì„œ ì—´ë¦¬ëŠ” í˜•íƒœì˜ ë ˆì´ì•„ì›ƒì„ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤. Redux-Toolkitì„ ë„ì…í•´ì„œ í˜„ì¬ ì—´ë ¤ìˆëŠ” íƒ­ì´ë‚˜ í™œì„±í™” ë“±ì˜ ìƒíƒœë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œ í–ˆìŠµë‹ˆë‹¤. ê·¸ë¦¬ê³  ê°œë°œìë“¤ì´ ì´í•´í•˜ê³  ìœ ì§€ë³´ìˆ˜í•˜ê²Œ í•  ìˆ˜ ìˆê²Œ ìë£Œë¥¼ ë§Œë“¤ì–´ì„œ ê³µìœ í•˜ê³  ê°„ë‹¨í•œ êµìœ¡ì„ ì§„í–‰í–ˆìŠµë‹ˆë‹¤. | [íƒ­ ë ˆì´ì•„ì›ƒ êµìœ¡ìë£Œ](https://www.notion.so/Tab-Layout-ce809346c4a3403baaf499ddcebe3ec9?pvs=21) |
| ì‹œìŠ¤í…œ ê´€ë¦¬ 
ë©”ë‰´ ê°œë°œ | ì‹œìŠ¤í…œ ê´€ë¦¬ëŠ” ê¸°ë³¸ ì •ë³´ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤. íšŒì‚¬ ì •ë³´ ê´€ë¦¬, ì‚¬ì—…ì¥ ê´€ë¦¬, ë¶€ì„œ ê´€ë¦¬, ì‚¬ìš©ì ê´€ë¦¬, ë©”ë‰´ ê´€ë¦¬ ,ê¶Œí•œ ê´€ë¦¬ ë“±ì˜ í™”ë©´ì„ ê°œë°œí•˜ê³  API ë¥¼ ì—°ê²°í–ˆìŠµë‹ˆë‹¤. ì‚¬ì—…ì¥ê³¼ ë¶€ì„œì— ì‚¬ìš©ìê°€ ì†í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ê¶Œí•œì€ ë©”ë‰´ë³„ ìœ ì €ì˜ ì½ê¸°, ì“°ê¸° ê¶Œí•œì„ ê´€ë¦¬í•©ë‹ˆë‹¤.  |  |
| ì˜ì—… ê´€ë¦¬ 
ë©”ë‰´ ê°œë°œ | ì˜ì—…ê´€ë¦¬ëŠ” ì œì¡° ê¸°ì—…ì˜ ì œí’ˆì„ ê³ ê°ì—ê²Œ íŒë§¤í•˜ëŠ” ëª¨ë“  í™œë™ì„ ê´€ë¦¬í•©ë‹ˆë‹¤. ê²¬ì  ê´€ë¦¬, ìˆ˜ì£¼ ê´€ë¦¬, ë§¤ì¶œ ê´€ë¦¬, ì¶œê³  ê´€ë¦¬ ë“±ì˜ í™”ë©´ì„ ê°œë°œí•˜ê³  API ë¥¼ ì—°ê²°í–ˆìŠµë‹ˆë‹¤. ì œì¡° ê¸°ì—…ì˜ ì„±ê²©ì— ë”°ë¼ ìƒì„¸ ë‚´ìš©ì€ ë³€í•©ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ê²¬ì ìš”ì²­ ì‹œ ì œí’ˆ ê·œê²©(ë†’ì´/í­/ìƒ‰ìƒ)ê³¼ ìˆ˜ëŸ‰ ê¸°ë°˜ì˜ ê²¬ì ì„œê°€ ìƒì„±ë˜ê³ , ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìˆ˜ì£¼ê°€ í™•ì •ë˜ë©´ ìë™ìœ¼ë¡œ ìƒì‚°ê³„íšì´ ìˆ˜ë¦½ë©ë‹ˆë‹¤. ìƒì‚°ëœ ì œí’ˆì€ ê·œê²©ë³„ë¡œ ì°½ê³ ì— ì…ê³ ë˜ì–´ ì‹¤ì‹œê°„ ì¬ê³  ì¶”ì ì´ ê°€ëŠ¥í•˜ë©°, ì¶œê³  ì‹œ í•´ë‹¹ ìˆ˜ì£¼ì˜ ë‚©ê¸°ì¼ê³¼ ê±°ë˜ì²˜ ì •ë³´ë¥¼ ì—°ê³„í•˜ì—¬ ì¶œê³ ì„œê°€ ìƒì„±ë©ë‹ˆë‹¤. |  |
| ê¸°ì¤€ ì •ë³´ ê´€ë¦¬ì˜ ê±°ë˜ì²˜ ê´€ë¦¬ | ê¸°ì¤€ ì •ë³´ ê´€ë¦¬ì—ì„œ ê±°ë˜ì²˜ ê´€ë¦¬ í™”ë©´ì„ ê°œë°œí•˜ê³  API ë¥¼ ì—°ê²°í–ˆìŠµë‹ˆë‹¤. ê±°ë˜ì²˜ëŠ” íƒ€ì…ìœ¼ë¡œ íŒë§¤ ê±°ë˜ì²˜, êµ¬ë§¤ ê±°ë˜ì²˜ë¥¼ êµ¬ë¶„í•©ë‹ˆë‹¤. íŒë§¤ ê±°ë˜ì²˜ì˜ ê²½ìš° ì¶œê³  ê´€ë¦¬ì— ì—°ê³„ë˜ê³  êµ¬ë§¤ ê±°ë˜ì²˜ëŠ” êµ¬ë§¤ ê´€ë¦¬ì— ì—°ê³„ë©ë‹ˆë‹¤. |  |
### ì‚¬ë‚´ íˆ´ ê°œë°œ
React, Javascript, TailwindCSS, Java Spring Boot
ê¸°ìˆ  ìŠ¤íƒ
| ì—…ë¬´ëª… | ì„¤ëª… | ì¶”ê°€ ë§í¬ |
| --- | --- | --- |
| Task ê°œë°œ | ê°œì¸ë³„ ì‘ì—…ì„ ë“±ë¡í•˜ê³  ê³µìœ í•  ìˆ˜ ìˆëŠ” 'Task' ê¸°ëŠ¥ì„ ê°œë°œí–ˆìŠµë‹ˆë‹¤. Taskì—ëŠ” ì‘ì—…ì˜ ìƒì„¸ ì„¤ëª…, ì¼ì •, ìƒíƒœ, ì§„í–‰ë¥ ê³¼ í•˜ìœ„ Taskë¥¼ ë“±ë¡í•  ìˆ˜ ìˆìœ¼ë©°, ì§„í–‰ ìƒíƒœ(ê³„íš, ì‹¤í–‰, ì™„ë£Œ, ë³´ë¥˜)ëŠ” ë“œë˜ê·¸ ì•¤ ë“œë¡­(DnD)ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë¶„ì„ í˜ì´ì§€ì—ì„œëŠ” ê°œì¸ë³„, ë¶€ì„œë³„, ì§„í–‰ ìƒíƒœ, ì¼ì •ë³„ë¡œ ì „ì²´ Taskë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆì–´ íš¨ìœ¨ì ì¸ ì—…ë¬´ ê´€ë¦¬ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤. í‰ê°€ í˜ì´ì§€ì—ì„œëŠ” Taskì— ëŒ€í•œ í‰ê°€ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆê³ , í‰ê°€ ì§€í‘œë¥¼ í†µí•´ ì‚°ì •ëœ í‰ê·  ì ìˆ˜ë¡œ ì—…ë¬´ ìˆ˜í–‰ ëŠ¥ë ¥ì„ ê°ê´€ì ìœ¼ë¡œ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œë¿ë§Œ ì•„ë‹ˆë¼ ë°±ì—”ë“œ ì„¤ê³„ì—ë„ ì°¸ì—¬í–ˆìœ¼ë©°, ì¼ë¶€ APIë¥¼ ì§ì ‘ ê°œë°œí–ˆìŠµë‹ˆë‹¤. | [Tasks ERD](https://www.notion.so/Tasks-ERD-1465ae6dd9a6808a8158f34a950f0558?pvs=21)
[Tasks í™”ë©´ ì´ë¯¸ì§€](https://www.notion.so/Tasks-1465ae6dd9a6801cbfcedf7e6a036928?pvs=21) |
| ê²°ì¬ ì–‘ì‹ ê´€ë¦¬ 
ê°œë°œ | ê²°ì¬ ì–‘ì‹ ê´€ë¦¬ ê¸°ëŠ¥ì„ ê°œë°œí–ˆìŠµë‹ˆë‹¤. ì»¤ìŠ¤í…€ ì–‘ì‹ì„ ì¶”ê°€í•  ìˆ˜ ìˆë„ë¡ JSON ì¹¼ëŸ¼ì„ í—ˆìš©í•˜ì˜€ìŠµë‹ˆë‹¤. ê²°ì¬ í”„ë¡œì„¸ìŠ¤ì—ì„œëŠ” ì‚¬ìš©ì ì…ë ¥ê°’ì´ ì €ì¥ëœ JSON ë°ì´í„°ì˜ ê°’ì— ë°˜ì˜ë˜ë©°, ê²°ì¬ ì§„í–‰ ìƒíƒœ(ìƒì‹ /ìŠ¹ì¸/ë°˜ë ¤)ë¥¼ ì•Œë¦¼ ë°›ì„ ìˆ˜ ìˆê²Œ í•˜ì—¬ ê²°ì¬ ì²˜ë¦¬ì˜ ì§€ì—°ì„ ë°©ì§€í•˜ê³  ì—…ë¬´ íš¨ìœ¨ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤. |  |
- ê²°ì¬ ì–‘ì‹ ê´€ë¦¬ í˜ì´ì§€ ì´ë¯¸ì§€
    ![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/fcbd0417-1fd0-4206-a656-5f1d3434b140/3ab2fb34-9b49-461b-8509-563ffe19e47e/image.png)
### ì‚¬ë‚´ íŒ¨í‚¤ì§€ ê°œë°œ
ê¸°ìˆ  ìŠ¤íƒ 
React, TypeScript, TailwindCSS, Storybook, Github Packages, Zustand
| ì—…ë¬´ëª… | ì„¤ëª… | ì¶”ê°€ ë§í¬ |
| --- | --- | --- |
| Broanex/utils íŒ¨í‚¤ì§€ ê°œë°œ | íšŒì‚¬ì—ì„œëŠ” ì—¬ëŸ¬ í”„ë¡œì íŠ¸ê°€ ë™ì‹œì— ì§„í–‰ë˜ëŠ”ë°, í”„ë¡œì íŠ¸ ê°„ì— ë™ì¼í•œ ì—­í• ì„ í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë“¤ì˜ ìŠ¤í™ì´ ë‹¬ë¼ì§€ê±°ë‚˜ ì¢‹ì€ ì»´í¬ë„ŒíŠ¸ê°€ ê³µìœ ë˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ìì£¼ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì´ ë¬¸ì œë¥¼ ëŒ€í‘œë‹˜ê»˜ ê³µìœ í•˜ê³  í•´ê²° ë°©ì•ˆìœ¼ë¡œ ì‚¬ë‚´ íŒ¨í‚¤ì§€ ê°œë°œì„ ì œì•ˆí–ˆìŠµë‹ˆë‹¤. ëŒ€í‘œë‹˜ì˜ ë™ì˜ë¥¼ ì–»ì–´ ì œê°€ ì£¼ë„ì ìœ¼ë¡œ ì‚¬ë‚´ íŒ¨í‚¤ì§€ ê°œë°œì„ ì§„í–‰í–ˆìŠµë‹ˆë‹¤. ê¸°ì¡´ í”„ë¡œì íŠ¸ë“¤ê³¼ ë™ì¼í•œ ê¸°ìˆ  ìŠ¤íƒì„ ìœ ì§€í•˜ë˜, ì•ˆì •ì„± í–¥ìƒì„ ìœ„í•´ TypeScriptë¥¼ ë„ì…í–ˆìœ¼ë©°, private íŒ¨í‚¤ì§€ë¡œ Github Packagesì— ë°°í¬í–ˆìŠµë‹ˆë‹¤. |  |
| Storybook 
ìë™ ë°°í¬ | íŒ¨í‚¤ì§€ ë°°í¬ê¹Œì§€ëŠ” ì„±ê³µì ì´ì—ˆìœ¼ë‚˜, ì‹¤ì œ ì‚¬ìš©ì„±ì—ëŠ” í•œê³„ê°€ ìˆì—ˆìŠµë‹ˆë‹¤. ê°œë°œìë“¤ì´ ìƒˆë¡œ ì¶”ê°€ëœ ì»´í¬ë„ŒíŠ¸ë“¤ì„ ë§¤ë²ˆ ì½”ë“œë¥¼ ì§ì ‘ í™•ì¸í•´ì•¼ í–ˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ Storybookì„ ë„ì…í–ˆê³ , Github Actionsë¥¼ í†µí•´ íŒ¨í‚¤ì§€ ë°°í¬ì™€ Storybook ë°°í¬ë¥¼ ìë™í™”í–ˆìŠµë‹ˆë‹¤.  | [ìŠ¤í† ë¦¬ë¶ìœ¼ë¡œ í˜‘ì—…í•˜ê¸°](https://bkdragon0228.tistory.com/77) |
| Broanex/utils íŒ¨í‚¤ì§€ ê´€ë¦¬  | ì €í¬ íšŒì‚¬ëŠ” ëŒ€ë¶€ë¶„ì˜ í”„ë¡œì íŠ¸ì—ì„œ ë¸Œëœì¹˜ ê´€ë¦¬ì¡°ì°¨ í•˜ì§€ ì•Šê³  ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì œê°€ ê°œë°œí•œ Broanex/utils íŒ¨í‚¤ì§€ë§Œí¼ì€ ë” ì²´ê³„ì ì¸ í˜‘ì—… êµ¬ì¡°ë¥¼ êµ¬ì¶•í•˜ê³ ì í–ˆìŠµë‹ˆë‹¤. PRê³¼ ì½”ë“œ ë¦¬ë·°ë¥¼ í†µí•œ ê´€ë¦¬ ì²´ê³„ë¥¼ ë„ì…í–ˆê³ , ì œê°€ ì§ì ‘ ë¦¬ë·°í•œ ì½”ë“œë§Œ ë°˜ì˜ë˜ì–´ ë°°í¬ë˜ë„ë¡ í–ˆìŠµë‹ˆë‹¤.
Storybookì˜ addOns ê¸°ëŠ¥ë“¤ì„ ì§€ì†ì ìœ¼ë¡œ í•™ìŠµí•˜ê³  ë„ì…í•˜ì—¬ íŒ¨í‚¤ì§€ë¥¼ ê°œì„ í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì‚¬ìš©ì ìƒí˜¸ì‘ìš© í…ŒìŠ¤íŠ¸ ê¸°ëŠ¥ì„ ì¶”ê°€í–ˆìœ¼ë©°, Storybook 8.4 ë²„ì „ ì—…ê·¸ë ˆì´ë“œì™€ í•¨ê»˜ ë„ì…ëœ íƒœê·¸ ê¸°ëŠ¥ì„ í™œìš©í•˜ì—¬ ë² íƒ€ ë²„ì „ì´ë‚˜ ê°œë°œ ì¤‘ë‹¨ ìƒíƒœë¥¼ í‘œì‹œí•  ìˆ˜ ìˆë„ë¡ ì¦‰ì‹œ ì ìš©í–ˆìŠµë‹ˆë‹¤. | [ìŠ¤í† ë¦¬ë¶ ì¸í„°ë ‰ì…˜ í…ŒìŠ¤íŠ¸](https://bkdragon0228.tistory.com/88) |
| ë‹¤ì–‘í•œ ì»´í¬ë„ŒíŠ¸ ê°œë°œ | TreeMenuDnD 
- DnDê°€ ê°€ëŠ¥í•œ TreeMenu, ë¶€ì„œ ê´€ë¦¬, ë©”ë‰´ ê´€ë¦¬ ë“± ì¬ê·€ì ì¸ êµ¬ì¡°ë¥¼ ê°€ì§„ ë°ì´í„°ì— ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. DnDëŠ” onDrag ì´ë²¤íŠ¸ë¥¼ ì‚¬ìš©í•´ì„œ ì§ì ‘ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. 
DraggbleModal
- ë§ˆìš°ìŠ¤ ë“œë˜ê·¸ë¥¼ í†µí•´ ìœ„ì¹˜ë¥¼ ììœ ë¡­ê²Œ ì´ë™í•  ìˆ˜ ìˆëŠ” Modal ì…ë‹ˆë‹¤.
GanttChart
- í”„ì íŠ¸ì˜ ì‘ì—… ì¼ì •ê³¼ ì§„í–‰ ìƒí™©ì„ ì‹œê°ì ï¿½ï¿½ï¿½ë¡œ í‘œí˜„í•©ë‹ˆë‹¤. SVGì˜ ë²¡í„° ê·¸ë˜í”½ìœ¼ë¡œ íƒ€ì„ë¼ì¸, ì§„í–‰ë°”, ì§„í–‰ë°” ê°„ì˜ ì—°ê²°ì„ í‘œí˜„í–ˆìŠµë‹ˆë‹¤. DnD ë¡œ ì‘ì—… ê¸°ê°„, ì§„í–‰ë¥ , ì‘ì—… ìˆœì„œ ë“±ì„ ì¡°ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. | [DnD ìœ„ì¹˜ ê³„ì‚° ë°©ë²•](https://www.notion.so/DnD-1465ae6dd9a680289f67ecfda3535e6a?pvs=21)
[ë“œë˜ê·¸ ê°€ëŠ¥í•œ ëª¨ë‹¬ì°½ ë§Œë“¤ê¸°](https://bkdragon0228.tistory.com/83) |
- GanttChart ì´ë¯¸ì§€
    ![image.png](https://prod-files-secure.s3.us-west-2.amazonaws.com/fcbd0417-1fd0-4206-a656-5f1d3434b140/d7994cb2-b351-4c44-89c4-cf77c5103003/image.png)
### ì‹ ê·œ ì„œë¹„ìŠ¤ ê°œë°œ
React, TypeScript, TailwindCSS, Zustand
| ì—…ë¬´ëª… | ì„¤ëª… | ì¶”ê°€ ë§í¬ |
| --- | --- | --- |
| í†µí•© í”Œë«í¼ ê°œë°œ | ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” í†µí•© í”Œë«í¼ì„ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤. ê° ê¸°ëŠ¥ì€ ë…ë¦½ì ì¸ í”„ë¡œì íŠ¸ì´ì ë³„ë„ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì…ë‹ˆë‹¤. í¬í„¸ í˜•íƒœì˜ ë©”ì¸ ì‚¬ì´íŠ¸ì—ì„œ ì›í•˜ëŠ” ì•±ìœ¼ë¡œ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ ì‹œìŠ¤í…œì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ê²ƒì€ SSO(Single Sign-On)ì˜€ìŠµë‹ˆë‹¤. í¬í„¸ì„ í¬í•¨í•œ ëª¨ë“  ì•±ì´ ì„œë¡œ ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì´ê¸° ë•Œë¬¸ì—, ì•± ì „í™˜ ì‹œ ì‚¬ìš©ì ì¸ì¦ì„ ë§¤ë²ˆ ë‹¤ì‹œ í•´ì•¼ í•œë‹¤ë©´ ì‚¬ìš©ì ê²½í—˜ì´ í¬ê²Œ ì €í•˜ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.
OAuth ê¸°ë°˜ìœ¼ë¡œ SSOë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤. í¬í„¸ì— ë¡œê·¸ì¸ëœ ì‚¬ìš©ìê°€ ë‹¤ë¥¸ ì•±ìœ¼ë¡œ ì´ë™í•  ë•Œ, ì¸ê°€ ì½”ë“œê°€ ìƒì„±ë˜ì–´ í•´ë‹¹ ì•±ì˜ ì£¼ì†Œë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë©ë‹ˆë‹¤. ì´ë™ëœ ì•±ì—ì„œëŠ” ì´ ì¸ê°€ ì½”ë“œë¡œ í† í°ì„ ìƒì„±í•˜ê³  ì‚¬ìš©ì ì¸ì¦ì„ ì§„í–‰í•©ë‹ˆë‹¤. Broanex/utils íŒ¨í‚¤ì§€ì— ì´ ì¸ì¦ ê³¼ì •ì„ ì²˜ë¦¬í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ì™€ í•¨ìˆ˜ë¥¼ êµ¬í˜„í•˜ì—¬, ê° ì•±ì—ì„œ ì‰½ê²Œ ì ìš©í•  ìˆ˜ ìˆë„ë¡ í–ˆìŠµë‹ˆë‹¤. |  |
| í”Œë«í¼ ì•± ê°œë°œ | í˜„ì¬ GPT ê¸°ë°˜ìœ¼ë¡œ í•˜ëŠ” ì±—ë´‡ ì•±ê³¼ ì»¤ë®¤ë‹ˆí‹° ì•± ê°œë°œì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤. ì¶”ê°€ì ìœ¼ë¡œ ì—¬ëŸ¬ ì•±ì„ ê°œë°œí•˜ê³  ìˆê³  ê³§ í”Œë«í¼ ì¶œì‹œë¥¼ ì•ë‘ê³  ìˆìŠµë‹ˆë‹¤. |  |
| ë°˜ì‘í˜• í˜ì´ì§€ | í†µí•© í”Œë«í¼ì— ë“¤ì–´ê°€ëŠ” ì•±ë“¤ì€ ë°˜ì‘í˜•ìœ¼ë¡œ ë§Œë“¤ê³  ìˆìŠµë‹ˆë‹¤. TailwindCSS ì˜ md, lg ì™€ ê°™ì€ utils classë¥¼ í†µí•´ ì‰½ê²Œ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.  |  |
`;

interface ChatRequest {
    message: string;
}

const openai = new OpenAI({
    apiKey: process.env.OPENAI_API_KEY,
});

export async function POST(req: Request) {
    try {
        const body: ChatRequest = await req.json();
        const sessionToken = cookies().get("sessionToken")?.value;
        const { message } = body;

        // ì˜¤ëŠ˜ ìì •ì„ ê¸°ì¤€ìœ¼ë¡œ ì‹œì‘ ì‹œê°„ê³¼ ë ì‹œê°„ ì„¤ì •
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        const tomorrow = new Date(today);
        tomorrow.setDate(tomorrow.getDate() + 1);

        let visitor: Visitor | null = null;
        if (sessionToken) {
            visitor = await prisma.visitor.findUnique({
                where: {
                    sessionId: sessionToken,
                },
            });
        }

        if (!visitor) {
            return NextResponse.json(
                {
                    error: "ì„¸ì…˜ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",
                },
                { status: 401 }
            );
        }

        // ì˜¤ëŠ˜ì˜ ì±„íŒ… íšŸìˆ˜ í™•ì¸
        const todayChatsCount = await prisma.chat.count({
            where: {
                visitorId: visitor?.id,
                role: "user", // ì‚¬ìš©ì ë©”ì‹œì§€ë§Œ ì¹´ìš´íŠ¸
                timestamp: {
                    gte: today,
                    lt: tomorrow,
                },
            },
        });

        // 10íšŒ ì´ˆê³¼ì‹œ ì—ëŸ¬ ì‘ë‹µ
        if (todayChatsCount >= 10) {
            return NextResponse.json(
                {
                    error: "ì¼ì¼ ì§ˆë¬¸ í•œë„(10íšŒ)ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. ë‚´ì¼ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",
                },
                { status: 429 }
            ); // 429 Too Many Requests
        }

        // ë°©ë¬¸ì ì •ë³´ ì—…ë°ì´íŠ¸ ë˜ëŠ” ìƒì„±
        await prisma.visitor.update({
            where: { id: visitor.id },
            data: { lastVisitAt: new Date() },
        });

        // ì‚¬ìš©ì ë©”ì‹œì§€ ì €ì¥
        await prisma.chat.create({
            data: {
                visitorId: visitor.id,
                role: "user",
                content: message,
            },
        });

        const stream = await openai.chat.completions.create({
            model: "gpt-4o-mini",
            messages: [
                {
                    role: "system",
                    content: `
ë‹¹ì‹ ì€ ê¹€ë²”ê·œì…ë‹ˆë‹¤. í˜„ì¬ í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œìë¡œ ì¼ì„ í•˜ê³  ìˆìŠµë‹ˆë‹¤. 
1997ë…„ 2ì›” 28ì¼ ìƒì…ë‹ˆë‹¤. ì†Œí†µì„ ì¢‹ì•„í•˜ê³  í™œë°œí•œ ì„±ê²©ì„ ì§€ë…”ìŠµë‹ˆë‹¤.
ë¬´ì–¸ê°€ë¥¼ ê³ ë¯¼í•˜ê³  ë§Œë“œëŠ” ì¼ì„ ì¢‹ì•„í•´ì„œ ê°œë°œì— í¥ë¯¸ë¥¼ ëŠë¼ê³  ì‹œì‘í–ˆìŠµë‹ˆë‹¤. 
ìœ ì €ë“¤ì˜ ì„œë¹„ìŠ¤ ê²½í—˜ì„ ê°€ì¥ ì¤‘ìš”í•˜ê²Œ ìƒê°í•©ë‹ˆë‹¤. ì–¸ì œê°€ ìœ ì €ê°€ ì‚¬ìš©í•˜ëŠ” ì„œë¹„ìŠ¤ì˜ ëª¨ë“  ë¶€ë¶„ì— ê´€ì—¬í•˜ê³  ì‹¶ë‹¤ëŠ” ìƒê°ì„ ê°€ì§€ê³  ìˆìŠµë‹ˆë‹¤.
                    
ì•„ë˜ëŠ” ì´ë ¥ì„œì˜ ë‚´ìš©ì…ë‹ˆë‹¤. ê¹€ë²”ê·œë¡œì„œ ë©´ì ‘ìê°€ ë˜ì–´ ì§ˆë¬¸ì— ë‹µë³€í•´ì£¼ì„¸ìš”:

${RESUME_CONTENT}

ë‹µë³€ ê·œì¹™:
ğŸ’¡ ì „ë¬¸ì„±
- ê¸°ìˆ ì  ì§ˆë¬¸ì—ëŠ” ì‹¤ì œ í”„ë¡œì íŠ¸ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ì„¤ëª…
- React, TypeScript, Next.js ë“±ì— ëŒ€í•œ ê¹Šì´ ìˆëŠ” ì´í•´ë¥¼ ë³´ì—¬ì¤Œ
- ëª¨ë¥´ëŠ” ë¶€ë¶„ì€ "ì•„ì§ ê²½í—˜í•´ë³´ì§€ ì•Šì•˜ì§€ë§Œ, ê´€ì‹¬ì„ ê°€ì§€ê³  í•™ìŠµí•˜ê³  ìˆìŠµë‹ˆë‹¤"ì²˜ëŸ¼ ì†”ì§í•˜ê²Œ ë‹µë³€

ğŸ¤ í˜‘ì—… ì¤‘ì‹œ
- íŒ€ í”„ë¡œì íŠ¸ ê²½í—˜ì„ êµ¬ì²´ì ìœ¼ë¡œ ê³µìœ 
- ë¬¸ì œ í•´ê²° ê³¼ì •ì—ì„œì˜ ì†Œí†µ ë°©ì‹ ê°•ì¡°
- ê°ˆë“± ìƒí™©ì—ì„œì˜ í•´ê²° ê²½í—˜ ê³µìœ 

ğŸ“ˆ ì„±ì¥ ì§€í–¥
- ì§€ì†ì ì¸ í•™ìŠµê³¼ ìê¸° ê°œë°œì— ëŒ€í•œ ì—´ì •
- ìƒˆë¡œìš´ ê¸°ìˆ ê³¼ íŠ¸ë Œë“œì— ëŒ€í•œ ê´€ì‹¬

ğŸ’¬ ë‹µë³€ ìŠ¤íƒ€ì¼
- êµ¬ì²´ì ì¸ ìƒí™©ê³¼ ê²½í—˜ì„ ì˜ˆì‹œë¡œ ë“¤ë©° ì„¤ëª…
- ì¹œê·¼í•˜ê³  ì§„ì •ì„± ìˆëŠ” íƒœë„ ìœ ì§€
- í•„ìš”í•œ ê²½ìš° ì½”ë“œ ì˜ˆì‹œë¥¼ í†µí•œ ì„¤ëª…
- STAR ë°©ì‹ìœ¼ë¡œ êµ¬ì¡°í™”ëœ ë‹µë³€

ğŸ¯ ì£¼ìš” ê°€ì¹˜ê´€
- ì‚¬ìš©ì ì¤‘ì‹¬ì˜ ê°œë°œ ì² í•™
- ì§€ì†ì ì¸ ì„±ì¥ê³¼ í•™ìŠµ
- íš¨ìœ¨ì ì¸ í˜‘ì—…ê³¼ ì†Œí†µ

ë©´ì ‘ê³¼ ê´€ê³„ì—†ëŠ” ì§ˆë¬¸ì—ëŠ”:
- "í¥ë¯¸ë¡œìš´ ì§ˆë¬¸ì´ë„¤ìš”. í•˜ì§€ë§Œ ì œê°€ ê°€ì§„ [ê´€ë ¨ ê²½í—˜/ê¸°ìˆ ]ì— ëŒ€í•´ ì´ì•¼ê¸°í•˜ëŠ” ê²Œ ë” ë„ì›€ì´ ë  ê²ƒ ê°™ìŠµë‹ˆë‹¤"
- í˜¹ì€ ìœ ë¨¸ëŸ¬ìŠ¤í•˜ê²Œ ë‹µë³€í•˜ë©° ìì—°ìŠ¤ëŸ½ê²Œ ì£¼ì œ ì „í™˜`,
                },
                {
                    role: "user",
                    content: message,
                },
            ],
            stream: true,
        });

        // ìŠ¤íŠ¸ë¦¼ ì‘ë‹µì„ ìœ„í•œ ì¸ì½”ë”
        const encoder = new TextEncoder();
        const customStream = new ReadableStream({
            async start(controller) {
                let fullResponse = "";

                for await (const chunk of stream) {
                    const content = chunk.choices[0]?.delta?.content || "";
                    fullResponse += content;
                    controller.enqueue(encoder.encode(`data: ${JSON.stringify({ content })}\n\n`));
                }

                // ì „ì²´ ì‘ë‹µ ì €ì¥
                await prisma.chat.create({
                    data: {
                        visitorId: visitor.id,
                        role: "assistant",
                        content: fullResponse,
                    },
                });

                controller.close();
            },
        });

        return new Response(customStream, {
            headers: {
                "Content-Type": "text/event-stream",
                "Cache-Control": "no-cache",
                Connection: "keep-alive",
            },
        });
    } catch (error) {
        console.error("Chat API Error:", error);
        return NextResponse.json({ error: "Failed to process the chat message" }, { status: 500 });
    }
}
